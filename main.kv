#:kivy 1.11.1
#:import platform kivy.utils.platform
#:import XCamera kivy_garden.xcamera
#:import CustomTextInput main_impl
# size_hint: Represents how much space the widget should use relative to its parentâ€™s width.
# pos_hint: Set position of widget inside its parent layout.
# file chooser is best described here https://kivy.org/doc/stable/api-kivy.uix.filechooser.html
# on_submit does not work in filechooser
# app.user_data_dir
<MainLayout>:
    orientation: 'vertical'
    id: mainlayoutid
    CustomTextInput:
        id: fchash
        size_hint: (1, .2)
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        text: mainlayoutid.fchash_text
        use_bubble: True
        allow_copy: True
        padding_x: (20, 20)
        padding_y: (20, 20)
    TabbedPanel:
        id: tabpanel
        size_hint: (1, .8)
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        do_default_tab: False
        TabbedPanelItem:
            id: tab1
            text: 'Open File'
            BoxLayout:
                orientation: 'vertical'
                BoxLayout:
                    size_hint_y: None
                    height: sp(52)
                    Button:
                        text: 'Icon View'
                        on_press: fc.view_mode = 'icon'
                    Button:
                        text: 'List View'
                        on_press: fc.view_mode = 'list'
                FileChooser:
                    id: fc
                    orientation: 'vertical'
                    on_selection: mainlayoutid.on_file_select(*args)
                    dirselect: False
                    multiselect: False
                    rootpath: '/storage/emulated/0' if platform == 'android' else '/tmp/'
                    FileChooserIconLayout
                    FileChooserListLayout
        TabbedPanelItem:
            text: 'New Photo'
            BoxLayout:
                orientation: 'vertical'
                XCamera:
                    id: camera
        TabbedPanelItem:
            text: 'User Name'
            BoxLayout:
                orientation: 'vertical'
                Label:
                    markup: True
                    text_size: root.width, None
                    size: self.texture_size
                    text: '\n\n[b]Instructions[/b]\n[b]1.[/b] The username should ideally uniquely identify you, so it can be your email address, or a twitter handle, but your real name is probably not unique enough.\n[b]2.[/b] The username can only contain alphanumeric characters and the period symbol.\n[b]3.[/b] The length of the username must be a multiple of 4.\n\n When you enter a username the app will automatically transform the input to an acceptable string. You can edit the original input and see its effect in real-time.'
                Label:
                    text: '[b]Configured Username[/b]'
                    markup: True
                    size: self.texture_size
                    text_size: root.width, None
                Label:
                    text: mainlayoutid.username_transformed
                    size: self.texture_size
                    text_size: root.width, None
                TextInput:
                    id: username_textinput
                    on_text: mainlayoutid.username_textinput_callback(self.text)
